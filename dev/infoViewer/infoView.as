package infoViewer{	import flash.display.Sprite;	import flash.events.EventDispatcher;	import flash.events.Event;	import textBuilder.textArea	import buttonBuild.infoBut	import caurina.transitions.Tweener;	import caurina.transitions.properties.DisplayShortcuts;	import buttonBuild.photoThumb;	public class infoView extends Sprite  {		private var _model:Object;		private var _controller:Object;		private var _xml:XML;		private var _text:textArea;		private var infoButton:infoBut		private var bgwidth:int		private var bgheight:int		public function infoView(m:Object,c:Object, xml:XML, i:int, v:int) {			// constructor code			_model = m;			_controller = c;			bgwidth=i			bgheight=v			_xml = new XML(xml);			//trace(_xml)			DisplayShortcuts.init();			//trace(stage.stageWidth,stage.stageHeight)			_model.addEventListener(infoModel.XMLUPDATE,xmlupdate);			_model.addEventListener(infoModel.INFOADD,buildinfoButtons);			//_model.addEventListener(infoModel.UPDATEGALL,moveGallery);			addEventListener(Event.ADDED_TO_STAGE,onAddedToStage);			//trace("added to Stage");		}		private function onAddedToStage(event:Event):void {			_controller.setXml(_xml);			removeEventListener(Event.ADDED_TO_STAGE,onAddedToStage);			addEventListener(Event.REMOVED_FROM_STAGE, removeFromStage);		}		private function xmlupdate(event:Event):void {					setText(0)							}		private function buildGallery(event:Event):void {			buildGalleryParts();			//buildGalleryPics()		}		private function buildGalleryParts():void {					}		private function setText(i:int):void {				_text = new textArea(_xml.item[i]);				addChildAt(_text, 0)				_text.alpha=0				_text.x = (bgwidth * .5) - (375 * .5);				_text.name = "text";				_text.y = (bgheight * .5) - (_text.height * .5);				Tweener.addTween(_text,{alpha:1,time:.3,transition:"easeOutQuad"})						}				private function buildinfoButtons(event:Event):void {			for (var i:int = 0; i < _model.fullInfo.length; i++)			{				infoButton = new infoBut(_model.fullInfo[i][1],_model.fullInfo[i][0]);				addChild(infoButton);				infoButton.name = "infoButton"+i;				infoButton.x = _model.fullInfo[i][2];				infoButton.y = _model.fullInfo[i][3];				infoButton.addEventListener(infoBut.UPDATE,update);			}				}				private function setNewText(i:int):void{			/*trace(_photoBig)			_photoBig = new photoBig(_model.fullGall[i][1],_model.fullGall[i][0],_model.fullGall[i][2])			picHolder.addChild(_photoBig)			_photoBig.alpha=0			Tweener.addTween(_photoBig,{alpha:1,time:.3,transition:"easeOutQuad"})			_photoBig.name="mainPhoto"			caption=new captionBox()			picHolder.addChild(caption)			caption.alpha=0			caption.descText.text=_model.fullGall[i][1]			_photoBig.addEventListener(photoBig.UPDATE, picPlace)*/		}				private function picPlace(event:Event):void {			/*_photoBig.removeEventListener(photoBig.UPDATE, picPlace)			_photoBig.y = (.5 * picBg.height)-(.5 * _photoBig.picHeight)			_photoBig.x = (.5 * picBg.width)-(.5 * _photoBig.picWidth)			caption.x = (.5 * picBg.width)-(.5 * caption.width)			caption.y = _photoBig.y+_photoBig.height			Tweener.addTween(caption,{alpha:1,time:.3,transition:"easeOutQuad"})*/		}		private function update(event:Event):void {			trace(event.target.buttonNum);			//_text.beginFlow(_xml.item[event.target.buttonNum])							cleanText(event)		}				private function moveGallery(event:Event):void {			//Tweener.addTween(thumbHolder,{y:_model.newThumbHolderPos,time:.3,transition:"easeOutQuad", onComplete:arrowCheck});					}				private function arrowCheck():void {			/*if (thumbHolder.y < 28 || thumbHolder.y > 28) {				up.visible=true				down.visible=true			}*/			/*if (thumbHolder.y != 28) {				Tweener.addTween(up,{_autoAlpha:1,time:.3,transition:"easeOutQuad"})				Tweener.addTween(down,{_autoAlpha:1,time:.3,transition:"easeOutQuad"})			}			if(thumbHolder.y==28) {				Tweener.addTween(up,{_autoAlpha:0,time:.3,transition:"easeOutQuad"})			}*/		}				private function cleanText(event:Event):void {			trace(event.target.buttonNum)			//Tweener.addTween(caption,{_autoAlpha:0,time:.3,transition:"easeOutQuad"})			Tweener.addTween(_text,{_autoAlpha:0,time:.3,transition:"easeOutQuad", onComplete: completeClick,onCompleteParams:[event] });		}				private function completeClick(event:Event):void {			removeChild(_text)			setText(event.target.buttonNum)		}				private function removeFromStage(event:Event):void{			/*removeChild(up) 			removeChild(down) 			up=null			down=null			removeChild(thumbMask)			thumbMask=null			while (thumbHolder.numChildren>0){				trace(thumbHolder.numChildren)				thumbHolder.getChildAt((thumbHolder.numChildren-1)).removeEventListener(photoThumb.UPDATE,update)				thumbHolder.removeChild(thumbHolder.getChildAt((thumbHolder.numChildren-1)))			}			removeChild(thumbHolder)			thumbHolder=null			while (picHolder.numChildren>0){				trace(picHolder.numChildren)				picHolder.removeChild(picHolder.getChildAt((picHolder.numChildren-1)))			}			removeChild(picHolder)			_model.removeEventListener(infoModel.XMLUPDATE,xmlupdate);			_model.removeEventListener(infoModel.GALLERYADD,buildGallery);			_model.removeEventListener(infoModel.UPDATEGALL,moveGallery);			_model=null			_controller=null			_xml=null			up=null			down=null*/		}			}}